trigger: none
pool: Default

jobs:
# - job: linting
#   steps:
#   - task: PowerShell@2
#     inputs:
#       targetType: 'inline'
#       script: 'npm i -D -E @biomejs/biome'
#       workingDirectory: '$(Build.SourcesDirectory)/ReactTodoUIMonolith-main'
  
#   - task: PowerShell@2
#     inputs:
#       targetType: 'inline'
#       script: 'npx @biomejs/biome init'
#       workingDirectory: '$(Build.SourcesDirectory)/ReactTodoUIMonolith-main'
#   - task: PowerShell@2
#     inputs:
#       targetType: 'inline'
#       script: 'npx biome lint .'
#       workingDirectory: '$(Build.SourcesDirectory)/ReactTodoUIMonolith-main'
      
  - job: build
    displayName: building application
    steps:

    - task: PowerShell@2
      inputs:
        targetType: 'inline'
        script: 'npm install'
        workingDirectory: '$(Build.SourcesDirectory)/ReactTodoUIMonolith-main'
    - task: PowerShell@2
      inputs:
        targetType: 'inline'
        script: 'npm run build'
        workingDirectory: '$(Build.SourcesDirectory)/ReactTodoUIMonolith-main'
    - task: PublishBuildArtifacts@1
      inputs:
        PathtoPublish: '$(Build.SourcesDirectory)/ReactTodoUIMonolith-main/build'
        ArtifactName: 'ReactTodoUI'
        publishLocation: 'Container'


  - deployment: deploy
    displayName: deploying code
    dependsOn: build
    environment: 
        name: 'dev'
        resourceType: VirtualMachine
    strategy: 
      runOnce:
        deploy:
          steps:
          - task: DownloadPipelineArtifact@2
            inputs:
              buildType: 'specific'
              project: '775e0587-b963-415e-85f6-eb77cb35ff50'
              definition: '4'
              buildVersionToDownload: 'specific'
              pipelineId: '18'
              artifactName: 'ReactTodoUI'
              targetPath: '$(Pipeline.Workspace)'
          
          
          
          



